# Connect to a BigQuery instance

To access an Google BigQuery project, Hackolade currently supports access using two methods, [Application Default Credentials](https://cloud.google.com/docs/authentication/set-up-adc-local-dev-environment) or [Service account](https://cloud.google.com/iam/docs/service-account-overview).

Choosing the most appropriate method depends on the use case.

If you want to connect from your local workstation, then you should favor using ***Application Default Credentials*** method because it allows for better auditing and access management, as you will be authenticated as a user to Google Cloud Platform.

While if your use case implies running the Hackolade Studio cli on servers (for instance using Docker), then you should favor using the ***Service Account*** because this method is tailored for ***Machine to Machine*** use cases.

## Application Default Credentials

ADC are created by the ***gcloud*** client on your workstation.

&nbsp;

Give a meaningful name to the connection, provide a specific project id you have access to and reference the path and name of the credential file generated by ***gcloud***.

&nbsp;

![BigQuery connection settings](<lib/BigQuery%20ADC%20connection%20settings.png>)

### Instructions to setup ADC on your local workstation

As stated by [Google Cloud Platform's documentation](https://cloud.google.com/docs/authentication/set-up-adc-local-dev-environment
):

1. Install [gcloud](https://cloud.google.com/sdk/docs/install) client on your workstation
2. Then initialize gcloud: ```gcloud init```
3. Authenticate yourself to GCP: ```gcloud auth application-default login```

Gcloud creates an ***application_default_credentials.json*** credential file in the following location depending on your system:

- Windows: ***${HOME}/Appdata/Roaming/gcloud/application_default_credentials.json***
- Mac: ***${HOME}/.config/gcloud/application_default_credentials.json***
- Linux: ***${HOME}/.config/gcloud/application_default_credentials.json***

Note that on Mac and Linux this location is in a hidden folder.  On Mac to be able to select it in a file picker you might need to use the ***CMD + SHIFT + .*** to for MacOS to show them in the picker.  On Linux all folders are displayed.

## Service account
Service Account Credentials are loaded from a file created in the [Google IAM \& Admin console](<https://console.cloud.google.com/iam-admin/iam> "target=\"\_blank\"") by your administrator.

&nbsp;

Give a meaningful name to the connection, optionally provide a specific project id, and reference the path and name of the key file provided by your administrator.

&nbsp;

![BigQuery connection settings](<lib/BigQuery%20Service%20Account%20connection%20settings.png>)

&nbsp;

The Hackolade process for reverse-engineering of Google BigQuery datasets includes the execution of SQL statements to discover datasets, tables and views, columns and their data types.&nbsp;

&nbsp;

### Instructions to create a Service Account key file

Here are the steps to follow:

&#49;) go to the IAM console, and choose [Service Accounts](<https://console.cloud.google.com/projectselector2/iam-admin/serviceaccounts?supportedpurview=project> "target=\"\_blank\"") in the menu

&#50;) select an existing project, and press the button + Create a Service Account

&#51;) provide the service account details, and create

&#52;) grant the following service account access to the project:

&nbsp; &nbsp; - BigQuery Data Viewer: in order to be able to perform reverse-engineering

and

&nbsp; &nbsp; - BigQuery Data Editor: in order to be able to forward-engineer (apply SQL script to instance)

&nbsp; &nbsp; - BigQuery Job User: in order to be able to forward-engineer (apply SQL script to instance)

![Image](<lib/BigQuery Service Account role creation.png>)

&nbsp;

then save the role

&#53;) select the action Manage Keys for the service account:

![BigQuery Service Account key creation](<lib/BigQuery Service Account key creation.png>)

&nbsp;

and create a new key with JSON type.&nbsp; The .json file gets downloaded in the browser.

&nbsp;

This is the file to be referenced in the connection settings dialog.

&nbsp;
