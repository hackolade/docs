# Delta model and ALTER script

The feature to create an ALTER script from the differences between 2 Hackolade data models is only available for the technologies that allow such syntax and that we support, currently: BigQuery, Cassandra and DataStax, Databricks and Delta Lake, Hive, MariaDB and SkySQL, MySQL, Oracle and Autonomous Database, PostgreSQL and EnterpriseDB, Amazon RDS, Redshift, SQL Server and Azure SQL, Google Cloud SQL, ScyllaDB, Snowflake, and Synapse.

&nbsp;

A delta model highlighting the differences between 2 data models in a structured manner can also be useful for other targets, even if the technology does not support ALTER statements.&nbsp; It remains a machine-readable comparison of the 2 models.

&nbsp;

The generation of an ALTER script is a 2-step process: first you initiate the comparison of 2 models to generate a "delta" model from the detected differences, then you forward-engineer the ALTER script from the delta model.&nbsp; These operations are possible either from the GUI application, or from the Command Line, but **only** with the Professional Edition or the Workgroup Edition.

&nbsp;

When comparing 2 models, one of the models is always the baseline with which the second one is being compared.&nbsp; But there are different use cases for the origin of the second model.&nbsp; The second model could be an evolution of the first one.&nbsp; Or the second model could be issued from the reverse-engineering of a production instance for example.&nbsp; There's an important nuance between these 2 approaches: when the second model is an evolution of the first one, the internal identifiers (automatically generated by the application) remain identical and provide a very reliable basis for the comparison.&nbsp; Whereas when the second model was issued from a reverse-engineering process, then the internal identifiers are different, meaning that the comparison can only be done based on object names.&nbsp; You may change the matching method from the default of internal to IDs, to business names or technical names.

&nbsp;

**VERY IMPORTANT:** In ALTER scripts, the DROP command may appear if a database, schema, table, column, view, index, etc is deleted or renamed.&nbsp; As this command can potentially result in loss of data, it is your responsibility as a user to decide whether such script command should be applied to the database.&nbsp; By default, when Hackolade generates DROP commands in ALTER scripts, we comment the DROP statements.&nbsp; As a user, you have to explicitly un-comment these lines, which signifies that you understand the consequences of applying such statements.

&nbsp;

## Generate delta model

There are 2 ways to generate a delta model: GUI or CLI.

&nbsp;

Using the GUI application [Compare \& Merge](<Compareandmergemodels.md>) functionality, you may review the differences in the side by side panel, then generate a delta model file.&nbsp; Options in the left panel let you adjust the display filtering, the matching method (internal IDs, business names or technical names), and the choice to ignore negligible properties (schemaId, description, remarks, comments, default, dependencies, sample, examples.)

&nbsp;

**Important:** the order of the Left and Right models is critical, as it determines whether differences become adds or deletes, and hence the resulting ALTER script.&nbsp; The convention used is that the Left model is the basis for the comparison, and the Right model is the evolution.&nbsp; An object present in the Left model and not the Right model will result in a DROP statement.&nbsp; Conversely, an object in the Right model that is not present in the left model will result in a ADD statement.&nbsp; The models can easily be swapped.

&nbsp;

**Important:** Typically, models are compared using the internal Hackolade ID for the objects in the model.&nbsp; That works well if both models have evolved from the same Hackolade base data model.&nbsp; However, if you compare a reference Hackolade model with a new model derived from the reverse-engineering of a database instance for example, then this new model has new and different internal GUID for the objects.&nbsp; As a result, the compare method must use object names matching, ideally technical names, otherwise business names.&nbsp; The application attempts to automatically detect such situation.&nbsp; You may easily change the matching method.

&nbsp;

&nbsp;

![Delta model compare](<lib/Delta%20model%20compare.png>)

&nbsp;

The delta model looks like any other model, but it is filled with objects that have been calculated during the comparison.&nbsp; It helps visualize, for each level of objects, the differences between the Left and the Right model, using the Left model as a basis.

![Compare and Merge delta model](<lib/Compare%20and%20Merge%20delta%20model.png>)

&nbsp;

&nbsp;

Using the Command Line Interface [compMod command](<https://hackolade.com/help/CommandLineInterface.html#compMod>), you can compare, on a schedule, event, or trigger, two Hackolade models to detect differences, and optionally merge them.&nbsp; Given identical parameters, the GUI and CLI generate identical delta models.

&nbsp;

&nbsp;

## Forward-Engineer ALTER script

The generation of the ALTER script is a separate step which provides different results depending on the target and syntax.&nbsp; For example, Cassandra does not support NOT NULL, so a change in this property will not result in any statement in the ALTER script.

&nbsp;

Again here, you can generate the ALTER script either via the GUI or the CLI.

&nbsp;

Using the the GUI application, you may review the ALTER script on screen first, then either apply it to your database instance from the lower script tab, or use the menu Tools \> Forward-Engineer \> Alter Script to output a file on your local file system.

&nbsp;

As noted earlier, all DROP statements are commented by default, as they can potentially result in loss of data.&nbsp; It is your responsibility as a user to decide whether such script commands should be applied to the database.&nbsp; As a user, you have to explicitly un-comment these lines, which signifies that you understand the consequences of applying such statements.

![Compare and Merge ALTER script](<lib/Compare%20and%20Merge%20ALTER%20script.png>)

&nbsp;

&nbsp;

Using the Command Line Interface [forwEng command](<https://hackolade.com/help/CommandLineInterface.html#forwEng>), you can generate, on a schedule, event, or trigger, the ALTER script to be stored in your repository or integrate in your DevOps CI/CD pipeline.

